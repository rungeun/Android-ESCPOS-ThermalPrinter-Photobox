# 🪐Android-ESCPOS-ThermalPrinter-Photobox

---
안드로이드 열전사 인쇄기(영수증 인쇄기) 포토박스

- [1. 레파지토리 간단 설명](#-레파지토리-간단-설명)
- [2. 시연](#-시연)
- [3. 기능 목록](#-기능-목록)
- [4. 입출력](#-입출력)
- [5. 구현 체크 리스트](#구현-체크-리스트)
- [6. 제작다](#-제작자)
- [7. 참고 문서](#-참고-문서)

---

## 🌿 레파지토리 간단 설명

라즈베리파이4에 [LineageOS 23.0 (Android 16)](https://konstakang.com/devices/rpi4/LineageOS23/)를 올려 포토박스를 구현한 레포지토리입니다.

- **H/W 제작 기간 :** 2주
- **S/W 개발 기간 :** 1주

---

### 주요 기능

![유즈케이스](/image/유즈케이스.png)

- **촬영**
    1. 인쇄를 선택한다.
    2. 포토 박스에 인쇄 매수을 입력한다.
    3. 프레임을 개수 선택한다.
    4. 프레임 디자인을 선택한다.
    5. 개인정보 이용동의를 한다.
    6. 프레임에 맞게 사진 촬영을 n번 한다.
    7. 인쇄중을 표시 후, uuid생성 및 중복 검사, 사진 흑백 처리, 데이터 포멧 변환을 한다.
    8. 촬영된 사진을 인쇄한다.
- **재인쇄**
    1. 재인쇄를 선택한다.
    2. 인쇄물 하단에 있는 QR코드를 포토박스에 내장된 스캐너로 스캔한다.
    3. 인쇄 매수를 입력한다.
    4. 재인쇄 가능 여부를 확인한다.
    5. 조회된 사진을 인쇄한다.
- **사진 및 영상 조회(다운로드)**
    1. 인쇄물 하단에 있는 QR코드를 스마트폰으로 스캔한다.
    2. 서버에 조회 요청을 한다.
    3. 사진 및 동영상 프리뷰를 보여준다.
    4. 사진 및 동영상을 다운로드 한다.
- **서버**
    1. 수신 받은 사진 및 영상 등의 데이터를 저장한다.
    2. 요청이 오면 UUID에 맞는 사진 및 영상을 송신한다.
    3. 2주가 지난 사진 및 영상은 삭제한다.

---

### SERVER DB

![PhotoBoxServerDB](/image/PhotoBoxServerDB.png)

### H/W

H/W 내용은 [HW-README](HW-model-blueprint/HW-README.md)에 작성되어 있습니다.

---

## 🌿 시연

~~영상 추가 예정~~

---

## 🌿 기능 목록

기능 목록은 아래와 같은 형식을 따름
> - [x] **{기능명}** **:** **({branch-type}/{ticket-number}-{description})**

- [x] **인쇄또는 재인쇄를 선택 : (feature/ATP-1-photo-capture)**
    - [x] 초기 대기화면
    - [x] 포토박스 타이틀 및 정보(개발자, 개발 레포, 홍보) 표시
    - [x] `인쇄` 버튼을 누를 경우 인쇄 화면으로 이동
    - [x] `재인쇄` 버튼을 누를 경우 재인쇄 화면으로 이동
- [ ] **포토 박스에 인쇄 매수을 입력 : feature/ATP-2-print-selection)**
    - [ ] 인쇄 매수 선택 화면
    - [ ] `업`, `다운` 버튼을 통해 인쇄 매수를 조정
    - [ ] 현재 선택된 인쇄 매수를 화면에 표시
    - [ ] `다음` 버튼을 통해 프레임 선택 화면으로 이동
- [ ] **프레임 개수 선택 : (feature/ATP-3-frame-selection)**
    - [ ] 프레임 개수 선택 화면
    - [ ] `업`, `다운` 버튼을 통해 프레임 개수를 조정
    - [ ] 현재 선택된 프레임 개수를 화면에 표시
    - [ ] 선택된 프레임 개수에 대한 예상 출력 모양을 화면에 표시
    - [ ] `다음` 버튼을 통해 촬영 화면으로 이동
- [ ] **프레임 디자인 선택 : (feature/ATP-8-frame-design-selection)**
    - [ ] 프레임 디자인 선택 화면
    - [ ] 프레임 적용 페이지 예시 프리뷰 표시
    - [ ] 프레임 목록 스크롤 기능
    - [ ] `프레임 이미지`를 눌러 프레임을 선택
    - [ ] {현재 프레임 페이지}/{총 프레임 페이지}를 화면에 표시
    - [ ] `이전 페이지`, `다음 페이지` 버튼을 프레임을 적용할 페이지 선택
    - [ ] `다음` 버튼을 통해 이용약관 화면으로 이동
- [ ] **카메라에서 촬영중인 영상을 화면에 표시 : (feature/ATP-4-camera-preview)**
    - [ ] 프레임 디자인 선택 화면에 프리뷰 영상 표시
- [ ] **개인정보 이용동의 : (feature/ATP-5-privacy-policy-consent)**
    - [ ] 이용 약관 전문 표시
    - [ ] 이용 약관 한줄요약 표시
    - [ ] `이용 약관 동의`체크박스를 누를 경우, `다음` 버튼 활성화
    - [ ] `다음` 버튼을 통해 촬영 화면으로 이동
- [ ] **사진 촬영 : (feature/ATP-6-multi-photo-shoot)**
    - [ ] 사진 촬영화면
    - [ ] 프레임에 맞게 사진 N번 촬영
    - [ ] 5~1 다운 카운터를 화면에 표시 후, 촬영
    - [ ] 다운 카운트 및 촬열 시 부저음 작동
    - [ ] 사진을 임시 저장
    - [ ] 화면 상단에 촬영된 사진 표시
    - [ ] 촬영이 완료된 후, 자동으로 인쇄중 화면으로 이동
- [ ] **영수증 인쇄기를 사용한 사진 인쇄 : (feature/ATP-7-photo-printing)**
    - [ ] 인쇄중 화면
    - [ ] 사진을 흑백으로 변환
    - [ ] 영수증 인쇄를 위한 데이터 포멧 변환
    - [ ] 영수증 인쇄기를 통한 인쇄
    - [ ] 로고, 날짜, 사진, 개발자 정보를 포함하여 출력
    - [ ] 특정 시간이 지난 후, 자동으로 인쇄 완료 화면으로 이동
- [ ] **인쇄 완료 : (feature/ATP-9-photo-printing-success)**
    - [ ] 인쇄 성공 화면
    - [ ] "인쇄가 완료 되었습니다." 화면에 표시
    - [ ]  `다음` 버튼을 통해 초기 화면으로 이동
- [ ] **재인쇄 QR코드 스캔 : (feature/ATP-10-qr-scan-reprint)**
    - [ ] 재인쇄 QR코드 스캔 화면
    - [ ] 가이드 이미지 표시
    - [ ] 가이드 출력문 표시
    - [ ] GPIO 제어를 통한 QR스캐너 활성화
    - [ ] 스캔된 값을 반환
    - [ ] `이전`으로 돌아가기 버튼을 누르면, 초기화면으로 이동
- [ ] **QR 스캔 값 예외 검사 : (feature/ATP-11-reprint-validation)**
    - [ ] QR코드 스캔 값에서 uuid 추출
    - [ ] 예외가 발생할 경우, 예외 사유룰 화면에 표시
    - [ ] 예외가 발생할 경우, __재인쇄 QR코드 스캔__ 화면에서 재입력 시도
- [ ] **재인쇄 가능 여부를 확인 : (feature/ATP-12-reprint-availability-check)**
    - [ ] DB에 uuid 존재 여부 확인
    - [ ] 사진 데이터 존재 여부 확인
    - [ ] 사진 조회 카운트 값 +1
    - [ ] 예외가 발생할 경우, 예외 사유룰 화면에 표시
    - [ ] 예외가 발생할 경우, __재인쇄 QR코드 스캔__ 화면에서 재입력 시도
- [ ] **재인쇄 매수를 입력 : (feature/ATP-13-reprint-count)**
    - [ ] 인쇄 매수 선택 화면
    - [ ] **인쇄 매수 입력** 화면(feature/ATP-2-print-selection)을 재활용
    - [ ] 현재까지 해당 사진 조회 횟수, 다운로드 횟수 정보 표시
    - [ ]  `다음` 버튼을 통해 **인쇄** 화면(eature/ATP-7-photo-printing)으로 이동
- [ ] ** : ()**
    - [ ] 
    - [ ] 
    - [ ] 
    - [ ] 
    - [ ] 
    - [ ] 
- [ ] ** : ()**
    - [ ] 
    - [ ] 
    - [ ] 
    - [ ] 
    - [ ] 
    - [ ] 
- [ ] ** : ()**
    - [ ] 
    - [ ] 
    - [ ] 
    - [ ] 
    - [ ] 
    - [ ] 

## 🌿 입출력

### 정상 입출력 상황

#### 인쇄 매수 선택

| ✓ | Index | 요약                      | 입력  | 예상 출력(대표) | 사유                                               |
|:-:|-------|-------------------------|-----|-----------|--------------------------------------------------|
|   | 1     | 아무 조작 없이 '다음' 버튼을 누른 경우 | `1` | `1`       | 기본값은 1(장)이다.                                     |
|   | 2     | 인쇄 매수 추가를 계속 누른 경우      | `6` | `6`       | 최대로 설정 가능한 인쇄 매수는 6이다. 추가 조작을 하여도 해당 수치를 넘지 않는다. |
|   | 3     |                         | ` ` | ` `       |                                                  |
|   | 4     |                         | ` ` | ` `       |                                                  |
|   | 5     |                         | ` ` | ` `       |                                                  |
|   | 6     |                         | ` ` | ` `       |                                                  |
|   | 7     |                         | ` ` | ` `       |                                                  |

#### 임시

| ✓ | Index | 요약 | 입력  | 예상 출력(대표) | 사유 |
|:-:|-------|----|-----|-----------|----|
|   | 1     |    | ` ` | ` `       |    |
|   | 2     |    | ` ` | ` `       |    |
|   | 3     |    | ` ` | ` `       |    |
|   | 4     |    | ` ` | ` `       |    |
|   | 5     |    | ` ` | ` `       |    |
|   | 6     |    | ` ` | ` `       |    |
|   | 7     |    | ` ` | ` `       |    |

#### 임시

| ✓ | Index | 요약 | 입력  | 예상 출력(대표) | 사유 |
|:-:|-------|----|-----|-----------|----|
|   | 1     |    | ` ` | ` `       |    |
|   | 2     |    | ` ` | ` `       |    |
|   | 3     |    | ` ` | ` `       |    |
|   | 4     |    | ` ` | ` `       |    |
|   | 5     |    | ` ` | ` `       |    |
|   | 6     |    | ` ` | ` `       |    |
|   | 7     |    | ` ` | ` `       |    |

---

### 예외 입출력 상황

#### 임시

| ✓ | Index | 요약 | 입력  | 예상 출력(대표)                                 | 사유 |
|:-:|-------|----|-----|-------------------------------------------|----|
|   | 1     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 2     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 3     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 4     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 5     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 6     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 7     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |

#### 임시

| ✓ | Index | 요약 | 입력  | 예상 출력(대표)                                 | 사유 |
|:-:|-------|----|-----|-------------------------------------------|----|
|   | 1     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 2     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 3     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 4     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 5     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 6     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 7     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |

#### 임시

| ✓ | Index | 요약 | 입력  | 예상 출력(대표)                                 | 사유 |
|:-:|-------|----|-----|-------------------------------------------|----|
|   | 1     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 2     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 3     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 4     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 5     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 6     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |
|   | 7     |    | ` ` | `IllegalArgumentException`<br/>`[ERROR] ` |    |

---

## 🌿구현 체크 리스트

[구현 체크 리스트](CHECKLIST.md) 참조

---

## 🌿 제작자

|                   [RunGeun](https://github.com/rungeun)                    |
|:--------------------------------------------------------------------------:|
| [![](https://github.com/rungeun.png?size=500)](https://github.com/rungeun) |
|                      **Contact me:** me@rungeun.space                      |

---

## 🌿 참고 문서

[라즈베리파이 4에 USB로 Android13 올리기](https://velog.io/@rungeun/raspberry-pi-4-install-android-13-via-usb)

[ESCPOS-ThermalPrinter-Android](https://github.com/DantSu/ESCPOS-ThermalPrinter-Android)

[LineageOS 23.0 (Android 16)](https://konstakang.com/devices/rpi4/LineageOS23/)